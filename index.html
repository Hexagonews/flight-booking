<!DOCTYPE html>
<html>
<head>
<title>LEGO Airport</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  margin:0;
  font-family:Segoe UI,Arial;
  background:linear-gradient(#6ec6ff,#eaf6ff);
}
header{
  background:#003366;
  color:white;
  padding:10px;
  display:flex;
  justify-content:space-between;
}
.panel{
  background:white;
  border-radius:16px;
  padding:15px;
  margin:10px;
  box-shadow:0 8px 20px rgba(0,0,0,.3);
  width:380px;
}
.container{
  display:flex;
  flex-wrap:wrap;
  justify-content:center;
}
button,input,select{
  width:100%;
  padding:8px;
  margin-top:6px;
  border-radius:8px;
  font-size:16px;
}
button{background:#ff9800;border:none;}
table{width:100%;border-collapse:collapse;}
th{background:#003366;color:white;}
td,th{padding:6px;text-align:center;}
.return{background:#fff4c2;}
#unlock{
  background:#2ecc71;
  color:white;
  margin:10px;
}
#loader{
  position:fixed;
  inset:0;
  background:#003366;
  color:white;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:30px;
  z-index:999;
}
.plane{
  position:fixed;
  bottom:40px;
  left:-100px;
  font-size:50px;
  animation:fly 6s linear forwards;
}
@keyframes fly{to{left:110%;}}
</style>
</head>

<body>

<div id="loader">Loading LEGO Airport…</div>

<header>
<h2>LEGO Airport</h2>
<div id="clock"></div>
</header>

<button id="unlock">Tap to enable airport announcements</button>

<div class="container">

<div class="panel">
<h3>Control Desk</h3>

Airline
<select id="airline">
  <option>Star Allegiance</option>
  <option>Eagle Alliance</option>
  <option>Cargo A</option>
  <option>Police Airlines</option>
  <option>Peak</option>
</select>

Destination
<select id="dest">
  <option>Living Room</option>
  <option>Aubrey's Mansion</option>
  <option>Julian's Room</option>
</select>

Ticket
<select id="type">
  <option>One-way</option>
  <option>Return</option>
</select>

Departure Time
<input type="time" id="time">

Return Time
<select id="returnTime">
  <option value="">Select Later</option>
  <option>12:00</option>
  <option>14:00</option>
  <option>16:00</option>
</select>

Seats
<input type="number" id="seats" min="1" value="1">

<button onclick="book()">Buy Ticket</button>
</div>

<div class="panel">
<h3>Departures</h3>
<table>
<thead>
<tr><th>Time</th><th>To</th><th>Gate</th><th>Seats</th><th>Status</th></tr>
</thead>
<tbody id="list"></tbody>
</table>
<div id="ann">No announcements</div>
</div>

</div>

<audio id="ding" src="https://www.soundjay.com/button/sounds/button-16.mp3"></audio>

<script>
let flights = JSON.parse(localStorage.flights||"[]");

function gateFor(a){
 if(a==="Cargo A") return "Cargo Gate";
 if(a==="Eagle Alliance") return "Gate 1";
 if(a==="Police Airlines") return "Gate 2";
 if(a==="Star Allegiance") return "Gate 3";
 return "Gate 2";
}

function seatLimit(a){
 if(a==="Star Allegiance") return 2;
 if(a==="Cargo A") return 999;
 return 7;
}

function to12(t){
 let[h,m]=t.split(":");h=parseInt(h);
 let a=h>=12?"PM":"AM";h=h%12||12;
 return h+":"+m+" "+a;
}

document.getElementById("unlock").onclick=()=>{
 let u=new SpeechSynthesisUtterance("Airport announcements enabled");
 speechSynthesis.speak(u);
 unlock.style.display="none";
};

function book(){
 let airline=airlineSel=airline.value;
 let desti=dest.value;
 let time=timeInput=time.value;
 let type=typeSel=type.value;
 let ret=returnTime.value;
 let seats=parseInt(seatsInput=seats.value);
 if(!time) return alert("Select time");

 addFlight(time,desti,seats,false,airline);
 if(type==="Return" && ret){
   addFlight(ret,"Return from "+desti,seats,true,airline);
 }
 localStorage.flights=JSON.stringify(flights);
}

function addFlight(time,dest,seats,isReturn,airline){
 let f=flights.find(x=>x.time===time && x.dest===dest && x.airline===airline);
 if(f){
   f.seats+=seats;
 } else {
   flights.push({
     time,dest,seats,airline,
     gate:gateFor(airline),
     status:"Scheduled",
     ann:false,
     final:false,
     ret:isReturn
   });
 }
}

function speak(t){
 ann.textContent=t;
 let d=ding;
 d.currentTime=0;
 d.play();
 d.onended=()=>{
   speechSynthesis.speak(new SpeechSynthesisUtterance(t));
 }
}

function loop(){
 let now=new Date();
 list.innerHTML="";
 flights.sort((a,b)=>a.time.localeCompare(b.time));

 flights.forEach(f=>{
  let [h,m]=f.time.split(":");
  let ft=new Date();ft.setHours(h,m,0);

  let boarding=new Date(ft-10*60000);
  let final=new Date(ft-3*60000);

  if(now>boarding && !f.ann && f.status==="Scheduled"){
    speak(`Flight to ${f.dest} now boarding at ${f.gate}`);
    f.ann=true;
  }
  if(now>final && !f.final && f.status==="Scheduled"){
    speak(`Final call for flight to ${f.dest} at ${f.gate}`);
    f.final=true;
  }
  if(now>ft && f.status==="Scheduled"){
    f.status=f.seats>0?"Departed":"Cancelled";
    let p=document.createElement("div");
    p.className="plane";
    p.textContent="✈️";
    document.body.appendChild(p);
    setTimeout(()=>p.remove(),6000);
  }

  let r=document.createElement("tr");
  if(f.ret) r.className="return";
  r.innerHTML=`<td>${to12(f.time)}</td><td>${f.dest}</td><td>${f.gate}</td><td>${f.seats}</td><td>${f.status}</td>`;
  list.appendChild(r);
 });

 localStorage.flights=JSON.stringify(flights);
}

setInterval(()=>{
 let d=new Date();
 clock.textContent=d.getHours()%12||12+":"+d.getMinutes().toString().padStart(2,"0");
 loop();
},1000);

setTimeout(()=>loader.style.display="none",2000);
</script>

</body>
</html>

